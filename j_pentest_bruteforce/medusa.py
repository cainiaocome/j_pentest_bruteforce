#!/usr/bin/env python3
# encoding: utf8

import os
import sys
import time
import traceback
import json
import queue
import argparse
import hashlib
import random
import subprocess
import socket

import j_pentest_utils

def medusa( ip, service, username, password ):
    """
        if service is not on default port, medusa has a -n option 
        to specify port, but i dont want to handle this for now
    """
    args = [ 'medusa', '-b', '-h', ip, '-M', service, '-u', username, '-p', password ]
    output = j_pentest_utils.bytes_to_unicode( subprocess.check_output( args ) )
    success_lines = list( filter( lambda line:line.find('ACCOUNT FOUND')!=-1, output.split( '\n' ) ) )
    return success_lines

def main():
    pass

if __name__ == '__main__':
    main()
